"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2957],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>d});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=u(n),d=i,m=c["".concat(s,".").concat(d)]||c[d]||h[d]||o;return n?a.createElement(m,r(r({ref:t},p),{},{components:n})):a.createElement(m,r({ref:t},p))}));function d(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=c;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,r[1]=l;for(var u=2;u<o;u++)r[u]=n[u];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},7704:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>d,frontMatter:()=>l,metadata:()=>u,toc:()=>h});var a=n(3117),i=n(102),o=(n(7294),n(3905)),r=["components"],l={id:"deploy-jupyterhub",title:"JupyterHub"},s=void 0,u={unversionedId:"deploy-jupyterhub",id:"deploy-jupyterhub",title:"JupyterHub",description:"JupyterHub is ideal to enable multiple users easily start predefined workspaces in the same project.",source:"@site/docs/deploy-jupyterhub.md",sourceDirName:".",slug:"/deploy-jupyterhub",permalink:"/docs/deploy-jupyterhub",draft:!1,editUrl:"https://github.com/MaastrichtU-IDS/dsri-documentation/edit/master/website/docs/deploy-jupyterhub.md",tags:[],version:"current",lastUpdatedBy:"Adekunle Onaopepo",lastUpdatedAt:1733158882,formattedLastUpdatedAt:"Dec 2, 2024",frontMatter:{id:"deploy-jupyterhub",title:"JupyterHub"},sidebar:"docs",previous:{title:"Matlab",permalink:"/docs/deploy-matlab"},next:{title:"Deploy Dask Cluster",permalink:"/docs/dask-cluster"}},p={},h=[{value:"Installing the Helm Chart repository",id:"installing-the-helm-chart-repository",level:2},{value:"Deploying JupyterHub \ud83e\ude90",id:"deploying-jupyterhub-",level:2},{value:"Installing the Helm Chart",id:"installing-the-helm-chart",level:3},{value:"Creating a secured route",id:"creating-a-secured-route",level:3},{value:"Persistent volumes",id:"persistent-volumes",level:3},{value:"Setting user&#39;s default persistent volume size",id:"setting-users-default-persistent-volume-size",level:3},{value:"Configuring an authentication method",id:"configuring-an-authentication-method",level:2},{value:"Dummy authentication",id:"dummy-authentication",level:3},{value:"allow_users/ admin_users authentication",id:"allow_users-admin_users-authentication",level:3},{value:"GitHub OAuth authentication",id:"github-oauth-authentication",level:3},{value:"Upgrading the config.yaml",id:"upgrading-the-configyaml",level:2}],c={toc:h};function d(e){var t=e.components,n=(0,i.Z)(e,r);return(0,o.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"JupyterHub is ideal to enable multiple users easily start predefined workspaces in the same project. "),(0,o.kt)("admonition",{title:"Experimental \ud83e\uddea ",type:"warning"},(0,o.kt)("p",{parentName:"admonition"},"Deploying JupyterHub is still experimental, and it can be a bit tricky to configure. Feel free to ",(0,o.kt)("a",{parentName:"p",href:"https://servicedesk.icts.maastrichtuniversity.nl/tas/public/ssp/content/serviceflow?unid=1ffa93e9ecd94d938ad46e3cb24c2392"},"submit a ticket")," to ask for help.")),(0,o.kt)("h2",{id:"installing-the-helm-chart-repository"},"Installing the Helm Chart repository"),(0,o.kt)("p",null,"After you have created a project you can start with installing the JupyterHub Helm Chart. If you do not have access to DSRI or created a project yet, and you need to find out how, please refer to our ",(0,o.kt)("a",{parentName:"p",href:"https://dsri.maastrichtuniversity.nl/docs/"},"documentation.")),(0,o.kt)("admonition",{title:"Helm Chart already available",type:"info"},(0,o.kt)("p",{parentName:"admonition"},"The Helm Chart should be already made available for everyone to use on the DSRI platform. There will be no need to install the repository yourself.")),(0,o.kt)("h1",{id:""}),(0,o.kt)("p",null,"Add the JupyterHub Helm Chart repository:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"helm repo add jupyterhub https://hub.jupyter.org/helm-chart/\nhelm repo update\n")),(0,o.kt)("p",null,"Or you can do this via the website:"),(0,o.kt)("p",null,"In ",(0,o.kt)("inlineCode",{parentName:"p"},"Developer")," mode in your project, go to ",(0,o.kt)("inlineCode",{parentName:"p"},"Helm")," in the sidepanel (1). Next, click on ",(0,o.kt)("inlineCode",{parentName:"p"},"Create")," and choose ",(0,o.kt)("inlineCode",{parentName:"p"},"Repository")," (2)."),(0,o.kt)("img",{src:"/img/jupyterhub-helm-chart-repo-add-one.png",alt:"",style:{maxWidth:"100%",maxHeight:"100%"}}),(0,o.kt)("h1",{id:"-1"}),(0,o.kt)("p",null,"Then fill in the ",(0,o.kt)("inlineCode",{parentName:"p"},"Name"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"Display Name"),", give it a ",(0,o.kt)("inlineCode",{parentName:"p"},"Description")," and fill in the ",(0,o.kt)("inlineCode",{parentName:"p"},"URL"),": ",(0,o.kt)("a",{parentName:"p",href:"https://hub.jupyter.org/helm-chart/"},"https://hub.jupyter.org/helm-chart/"),". "),(0,o.kt)("h1",{id:"-2"}),(0,o.kt)("p",null,"Next, click ",(0,o.kt)("inlineCode",{parentName:"p"},"Create"),". "),(0,o.kt)("img",{src:"/img/jupyterhub-helm-chart-repo-add-two.png",alt:"",style:{maxWidth:"100%",maxHeight:"100%"}}),(0,o.kt)("h2",{id:"deploying-jupyterhub-"},"Deploying JupyterHub \ud83e\ude90"),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"At the moment the latest -and only- version which is supported by DSRI is version 3.3.8. Newer versions will not work, and older versions are not tested and/or configured!")),(0,o.kt)("h1",{id:"-3"}),(0,o.kt)("p",null,"Download the preconfigured ",(0,o.kt)("inlineCode",{parentName:"p"},"config.yaml")," from our ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/MaastrichtU-IDS/dsri-documentation/tree/master/applications/jupyterhub"},"GitHub repository"),".\nThe default config that is provided by JupyterHub will not work. Certain things need to be changed for a working deployment. We have done this for you for version 3.3.8!"),(0,o.kt)("h3",{id:"installing-the-helm-chart"},"Installing the Helm Chart"),(0,o.kt)("p",null,"Install the Helm Chart using the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"helm upgrade --cleanup-on-fail \\\n  --install jupyterhub jupyterhub/jupyterhub \\\n  --version=3.3.8 \\\n  --namespace=<NAMESPACE> \\\n  --values config.yaml\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"<NAMESPACE>")," is the name of the namespace your project is in. "),(0,o.kt)("p",null,"Or you can do this via the website:"),(0,o.kt)("p",null,"In ",(0,o.kt)("inlineCode",{parentName:"p"},"Developer")," mode in your project, go to ",(0,o.kt)("inlineCode",{parentName:"p"},"Helm")," in the sidepanel (1). Next, click on ",(0,o.kt)("inlineCode",{parentName:"p"},"Create")," and choose ",(0,o.kt)("inlineCode",{parentName:"p"},"Helm Release")," (2)"),(0,o.kt)("img",{src:"/img/jupyterhub-helm-chart-install-one.png",alt:"",style:{maxWidth:"100%",maxHeight:"100%"}}),(0,o.kt)("h1",{id:"-4"}),(0,o.kt)("p",null,"Search for ",(0,o.kt)("inlineCode",{parentName:"p"},"jupyterhub")," (or the name you gave the repository if you added the repository yourself), and choose the ",(0,o.kt)("inlineCode",{parentName:"p"},"JupyterHub")," Helm Chart (1)."),(0,o.kt)("img",{src:"/img/jupyterhub-helm-chart-install-two.png",alt:"",style:{maxWidth:"100%",maxHeight:"100%"}}),(0,o.kt)("h1",{id:"-5"}),(0,o.kt)("p",null,"Click ",(0,o.kt)("inlineCode",{parentName:"p"},"Create"),"."),(0,o.kt)("img",{src:"/img/jupyterhub-helm-chart-install-three.png",alt:"",style:{maxWidth:"100%",maxHeight:"100%"}}),(0,o.kt)("h1",{id:"-6"}),(0,o.kt)("p",null,"Click the ",(0,o.kt)("inlineCode",{parentName:"p"},"Chart version")," drop down menu (1)."),(0,o.kt)("img",{src:"/img/jupyterhub-helm-chart-install-four.png",alt:"",style:{maxWidth:"100%",maxHeight:"100%"}}),(0,o.kt)("h1",{id:"-7"}),(0,o.kt)("p",null,"And choose the right Chart version: ",(0,o.kt)("inlineCode",{parentName:"p"},"3.3.8")," (1). Note that this is an important step, as we only support version 3.3.8 at the moment. Newer versions do not work yet and older versions we did not configure and/or test! "),(0,o.kt)("img",{src:"/img/jupyterhub-helm-chart-install-five.png",alt:"",style:{maxWidth:"100%",maxHeight:"100%"}}),(0,o.kt)("h3",{id:"creating-a-secured-route"},"Creating a secured route"),(0,o.kt)("p",null,"Create a secured route, with TLS edge termination:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"oc create route edge <NAME OF ROUTE> --namespace <NAMESPACE> --service=proxy-public --port=http\n")),(0,o.kt)("p",null,"Or you can do this via the website:"),(0,o.kt)("p",null,"In ",(0,o.kt)("inlineCode",{parentName:"p"},"Developer")," mode in your project, go to ",(0,o.kt)("inlineCode",{parentName:"p"},"Project")," in the sidepanel (1). Next, click on ",(0,o.kt)("inlineCode",{parentName:"p"},"Route")," (2)."),(0,o.kt)("img",{src:"/img/jupyterhub-helm-chart-route-one.png",alt:"",style:{maxWidth:"100%",maxHeight:"100%"}}),(0,o.kt)("h1",{id:"-8"}),(0,o.kt)("p",null,"Next, click ",(0,o.kt)("inlineCode",{parentName:"p"},"Create"),"."),(0,o.kt)("img",{src:"/img/jupyterhub-helm-chart-route-two.png",alt:"",style:{maxWidth:"100%",maxHeight:"100%"}}),(0,o.kt)("h1",{id:"-9"}),(0,o.kt)("p",null,"Fill in the ",(0,o.kt)("inlineCode",{parentName:"p"},"Name")," (1), choose the ",(0,o.kt)("inlineCode",{parentName:"p"},"Service"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"proxy-public")," (2), choose the ",(0,o.kt)("inlineCode",{parentName:"p"},"Target Port"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"80 -> http (TCP)")," (3), tick the box ",(0,o.kt)("inlineCode",{parentName:"p"},"Secure Route")," (4), and finally choose ",(0,o.kt)("inlineCode",{parentName:"p"},"TLS Termination"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"Edge")," (5). Next, click ",(0,o.kt)("inlineCode",{parentName:"p"},"Create"),", to create the route."),(0,o.kt)("img",{src:"/img/jupyterhub-helm-chart-route-three.png",alt:"",style:{maxWidth:"100%",maxHeight:"100%"}}),(0,o.kt)("h3",{id:"persistent-volumes"},"Persistent volumes"),(0,o.kt)("p",null,"Persistent volumes are automatically created for each user and instance started in JupyterHub to insure persistence of the data even JupyterHub is stopped. You can find the persistent volumes in the DSRI web UI, go to the ",(0,o.kt)("strong",{parentName:"p"},"Administrator")," view > ",(0,o.kt)("strong",{parentName:"p"},"Storage")," > ",(0,o.kt)("strong",{parentName:"p"},"Persistent Volume Claims"),"."),(0,o.kt)("h3",{id:"setting-users-default-persistent-volume-size"},"Setting user's default persistent volume size"),(0,o.kt)("p",null,"It is possible to change the default size of a persistent volume claim for a user in the ",(0,o.kt)("inlineCode",{parentName:"p"},"config.yaml"),". In our ",(0,o.kt)("inlineCode",{parentName:"p"},"config.yaml")," the default value is ",(0,o.kt)("inlineCode",{parentName:"p"},"2Gi"),". However if you think that your users will need more storage space you can change this default size in the ",(0,o.kt)("inlineCode",{parentName:"p"},"config.yaml"),". "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"singleuser:\n  # ...\n  storage:\n    capacity: 2Gi\n")),(0,o.kt)("h2",{id:"configuring-an-authentication-method"},"Configuring an authentication method"),(0,o.kt)("p",null,"At the moment we support three different authentication methods. One for testing purposes (dummy authenthication), one for people who are working alone in a JupyterHub instance or with one or two collaborators (allowed_users / admin_users authenthication), and one for allowing groups of people to collaborate in the same JupyterHub instance (GitHub OAuth). By default the dummy authentication is set in the ",(0,o.kt)("inlineCode",{parentName:"p"},"config.yaml"),". ",(0,o.kt)("strong",{parentName:"p"},"Note that this is only for testing purposes!!!")," However, with very few changes to the ",(0,o.kt)("inlineCode",{parentName:"p"},"config.yaml")," you can set up the other authentication methods. For reference see ",(0,o.kt)("a",{parentName:"p",href:"https://z2jh.jupyter.org/en/stable/administrator/authentication.html"},"the zero2jupyterhub documentation about authentication methods")),(0,o.kt)("h3",{id:"dummy-authentication"},"Dummy authentication"),(0,o.kt)("p",null,"This authentication method is set by default and is only there so that you can easily test your JupyterHub instance without the need of setting up proper authentication. The catch with this method is that whatever username/password combination you fill in, you will get access! In other words this is ",(0,o.kt)("strong",{parentName:"p"},"completely not safe to use in usecases other than testing!"),"\nIn the ",(0,o.kt)("inlineCode",{parentName:"p"},"config.yaml")," you see -besides the commented out other authentication methods- the following block of text:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"hub:\n  # ...\n  config:\n    JupyterHub:\n      admin_access: true\n      authenticator_class: dummy\n")),(0,o.kt)("p",null,"Some parts are intentionally left out here, shown as dots ",(0,o.kt)("inlineCode",{parentName:"p"},"# ...")," for better representation. If you are first setting up your JupyterHub instance you can leave this as is. Upon going to your instance via the URL you will get prompted with a login screen:"),(0,o.kt)("img",{src:"/img/jupyterhub-dummy-login.png",alt:"",style:{maxWidth:"100%",maxHeight:"100%"}}),(0,o.kt)("p",null,"Fill in any usernamer and password combination you would like and the useraccount will be made. Note that this useraccount really is made and has its own userpod in the deployment. It has a persistent volume as well and all other properties like any other useraccount that will be made. However you can use whatever password you will fill in to access this account. In other words do not use this user actively and definitely do not store any (sensitive) data in this useraccount!"),(0,o.kt)("h3",{id:"allow_users-admin_users-authentication"},"allow_users/ admin_users authentication"),(0,o.kt)("p",null,"If you will be working on your own in your JupyterHub instance it will be easiest to use the allow_users / admin_users authentication method. This method will let you specify an user and admin account with a shared password. ",(0,o.kt)("strong",{parentName:"p"},"It is important that you keep this password a secret and safe! If people will get their hands on this they can acces your JupyterHub instance and login as an admin, which can lead to hefty consequences.")," "),(0,o.kt)("p",null,"If you want to make use of this config uncomment the following block of text and comment out the previous block of text seen at the ",(0,o.kt)("inlineCode",{parentName:"p"},"Dummy authentication")," section above:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"hub:\n  # ...\n  config:\n    Authenticator:\n      admin_users:\n        - admin\n      allowed_users:\n        - user1\n    DummyAuthenticator:\n      password: a-shared-secret-password\n    JupyterHub:\n      authenticator_class: dummy\n")),(0,o.kt)("p",null,"Note that this password is in plaintext in your ",(0,o.kt)("inlineCode",{parentName:"p"},"config.yaml"),". ",(0,o.kt)("strong",{parentName:"p"},"Do not use password you use for other accounts, this is never a good idea and is surely not a good idea in this case!")," Unfortunately it is not possible to set passwords in JupyterHub using secrets in the DSRI at the moment. If you need to share your JupyterHub instance with others we recommend you to use the GitHub OAuth authentication method described below. "),(0,o.kt)("h3",{id:"github-oauth-authentication"},"GitHub OAuth authentication"),(0,o.kt)("p",null,"This authentication method is the most secure option we provide at the moment. The major caveat is that you and the people you want to collaborate with need a GitHub account. Moreover, you will need to create an organization and team within that organization, or have access to an organization and team. You grant the people authorization to log in into the JupyterHub instance with their GitHub account by adding them to a team in an organization in GitHub."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"hub:\n  # ...\n  config:\n    GitHubOAuthenticator:\n      client_id: your-client-id\n      client_secret: your-client-secret\n      oauth_callback_url: https://<route name>-<project name>.apps.dsri2.unimaas.nl/hub/oauth_callback\n    JupyterHub:\n      authenticator_class: github\n")),(0,o.kt)("p",null,"For creating an OAuth app in GitHub please refer to GitHub's ",(0,o.kt)("a",{parentName:"p",href:"https://docs.github.com/en/apps/oauth-apps/building-oauth-apps/creating-an-oauth-app"},"documentation."),". The GitHub OAuth app will provide your client ID and client secret. The ",(0,o.kt)("inlineCode",{parentName:"p"},"<route name>")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"<project name>")," you provided yourself in the previous steps, fill those in accordingly.\nTo set up an organization and team, please refer to GitHub's ",(0,o.kt)("a",{parentName:"p",href:"https://docs.github.com/en/organizations"},"documentation.")," as well. "),(0,o.kt)("h2",{id:"upgrading-the-configyaml"},"Upgrading the config.yaml"),(0,o.kt)("p",null,"You can upgrade your ",(0,o.kt)("inlineCode",{parentName:"p"},"config.yaml")," easily in the DSRI web UI if you would like to change certain settings, such as user's default persistent volume claims, authentication methods, and many more things. Note that in some cases users who created an account with an old authentication method will still have access via that method, make sure you set up your preferred authentication method before allowing users to authenticate and use the JupyterHub instance."),(0,o.kt)("h1",{id:"-10"}),(0,o.kt)("p",null,"In ",(0,o.kt)("inlineCode",{parentName:"p"},"Developer")," mode in your project, go to ",(0,o.kt)("inlineCode",{parentName:"p"},"Helm")," in the sidepanel (1). Next, click on your Helm Chart Release (2)."),(0,o.kt)("img",{src:"/img/jupyterhub-helm-chart-upgrade-chart-one.png",alt:"",style:{maxWidth:"100%",maxHeight:"100%"}}),(0,o.kt)("h1",{id:"-11"}),(0,o.kt)("p",null,"Now, click the ",(0,o.kt)("inlineCode",{parentName:"p"},"Actions")," drop down menu, and choose ",(0,o.kt)("inlineCode",{parentName:"p"},"Upgrade")," (1)."),(0,o.kt)("img",{src:"/img/jupyterhub-helm-chart-upgrade-chart-two.png",alt:"",style:{maxWidth:"100%",maxHeight:"100%"}}),(0,o.kt)("h1",{id:"-12"}),(0,o.kt)("p",null,"In the box -highlighted in the picutre below- you can make changes to the config.yaml. After you have made your changes click ",(0,o.kt)("inlineCode",{parentName:"p"},"Upgrade")," and your upgraded JupyterHub Helm Chart Release will automatically be deployed."),(0,o.kt)("img",{src:"/img/jupyterhub-helm-chart-upgrade-chart-three.png",alt:"",style:{maxWidth:"100%",maxHeight:"100%"}}),(0,o.kt)("h1",{id:"-13"}),(0,o.kt)("admonition",{title:"Configure JupyterHub",type:"success"},(0,o.kt)("p",{parentName:"admonition"},"Feel free to ",(0,o.kt)("a",{parentName:"p",href:"https://servicedesk.icts.maastrichtuniversity.nl/tas/public/ssp/content/serviceflow?unid=1ffa93e9ecd94d938ad46e3cb24c2392"},"submit a ticket")," to ask for help configuring your JupyterHub.")))}d.isMDXComponent=!0}}]);