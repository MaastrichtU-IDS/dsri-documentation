<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.69">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:200,300,400,400i,500,600,700">
<link rel="stylesheet" href="/dsri-documentation/css/code-blocks-buttons.css">
<script src="https://buttons.github.io/buttons.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
<script src="/dsri-documentation/js/code-blocks-buttons.js"></script><title data-react-helmet="true">GPU applications | Data Science Research Infrastructure</title><meta data-react-helmet="true" property="og:image" content="https://maastrichtu-ids.github.io//dsri-documentation/img/undraw_online.svg"><meta data-react-helmet="true" property="twitter:image" content="https://maastrichtu-ids.github.io//dsri-documentation/img/undraw_online.svg"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for Data Science Research Infrastructure"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="GPU applications | Data Science Research Infrastructure"><meta data-react-helmet="true" name="description" content="By default you do not have the permission to run applications on GPU, they need to be booked."><meta data-react-helmet="true" property="og:description" content="By default you do not have the permission to run applications on GPU, they need to be booked."><meta data-react-helmet="true" property="og:url" content="https://maastrichtu-ids.github.io//dsri-documentation/docs/deploy-on-gpu"><link data-react-helmet="true" rel="shortcut icon" href="/dsri-documentation/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://maastrichtu-ids.github.io//dsri-documentation/docs/deploy-on-gpu"><link rel="stylesheet" href="/dsri-documentation/styles.393ca935.css">
<link rel="preload" href="/dsri-documentation/styles.ce1431b2.js" as="script">
<link rel="preload" href="/dsri-documentation/runtime~main.ec3a32de.js" as="script">
<link rel="preload" href="/dsri-documentation/main.f513770f.js" as="script">
<link rel="preload" href="/dsri-documentation/1.e90966bd.js" as="script">
<link rel="preload" href="/dsri-documentation/1f391b9e.e7c3fa56.js" as="script">
<link rel="preload" href="/dsri-documentation/81.99b39d61.js" as="script">
<link rel="preload" href="/dsri-documentation/935f2afb.24337b0b.js" as="script">
<link rel="preload" href="/dsri-documentation/79.9c645739.js" as="script">
<link rel="preload" href="/dsri-documentation/707d3f57.950e90a2.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_2AhQ">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/dsri-documentation/"><img src="/dsri-documentation/img/favicon.ico" alt="Data Science Research Infrastructure" class="themedImage_2E_h themedImage--light_AouX navbar__logo"><img src="/dsri-documentation/img/favicon.ico" alt="Data Science Research Infrastructure" class="themedImage_2E_h themedImage--dark_1YPN navbar__logo"><strong class="navbar__title">Data Science Research Infrastructure</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/dsri-documentation/docs/">Documentation</a><a class="navbar__item navbar__link" href="/dsri-documentation/help">Help</a><a class="navbar__item navbar__link" href="/dsri-documentation/acknowledgement">Acknowledgement</a><a class="navbar__item navbar__link" href="/dsri-documentation/contributing">Contribute</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/MaastrichtU-IDS/dsri-documentation" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search searchBarContainer_1-U_"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_18Th searchBarLoadingRing_zYFK"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/dsri-documentation/"><img src="/dsri-documentation/img/favicon.ico" alt="Data Science Research Infrastructure" class="themedImage_2E_h themedImage--light_AouX navbar__logo"><img src="/dsri-documentation/img/favicon.ico" alt="Data Science Research Infrastructure" class="themedImage_2E_h themedImage--dark_1YPN navbar__logo"><strong class="navbar__title">Data Science Research Infrastructure</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/dsri-documentation/docs/">Documentation</a></li><li class="menu__list-item"><a class="menu__link" href="/dsri-documentation/help">Help</a></li><li class="menu__list-item"><a class="menu__link" href="/dsri-documentation/acknowledgement">Acknowledgement</a></li><li class="menu__list-item"><a class="menu__link" href="/dsri-documentation/contributing">Contribute</a></li><li class="menu__list-item"><a href="https://github.com/MaastrichtU-IDS/dsri-documentation" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link"></a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive thin-scrollbar menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Get started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/access-dsri">Access the DSRI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/start-workspace">Start your workspace</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/openshift-install">Install the client</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/openshift-load-data">Upload data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/openshift-delete-services">Delete an application</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/guide-monitoring">Monitor your applications</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Deploy applications</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/dsri-documentation/docs/guide-dockerfile-to-openshift">Deploy from a Dockerfile</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/dsri-documentation/docs/deploy-from-docker">Deploy from a Docker image</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/dsri-documentation/docs/anatomy-of-an-application">Anatomy of a DSRI application</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/dsri-documentation/docs/helm">Install from Helm charts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/dsri-documentation/docs/operators">Install from Operators</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Data Science catalog</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/dsri-documentation/docs/deploy-jupyter">Jupyter Notebooks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/dsri-documentation/docs/deploy-rstudio">RStudio</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/dsri-documentation/docs/deploy-vscode">VisualStudio Code</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/dsri-documentation/docs/deploy-database">Databases</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/dsri-documentation/docs/deploy-matlab">Matlab</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/dsri-documentation/docs/jupyterhub-spark">JupyterHub with Spark cluster</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/dsri-documentation/docs/deploy-spark">Spark cluster</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/dsri-documentation/docs/mpi-jobs">Run MPI jobs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/dsri-documentation/docs/neuroscience">Neuroscience research</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/dsri-documentation/docs/catalog-genomics">Genomics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/dsri-documentation/docs/catalog-imaging">Imaging softwares</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/dsri-documentation/docs/deploy-on-gpu">GPU applications</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/dsri-documentation/docs/catalog-utilities">Utilities</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/prepare-project-for-dsri">Prepare your project</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/guide-vpn">Install UM VPN</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/guide-workshop">Prepare a workshop</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/guide-known-issues">Known Issues</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/project-management">Create a new Project</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/login-docker-registry">Login to Docker registries</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/openshift-commands">Command Line Interface</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/openshift-storage">Data storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/guide-publish-image">Publish a Docker image</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/openshift-delete-objects">Delete objects (advanced)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/tools-machine-learning">Libraries for Machine Learning</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/glossary">Glossary</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Workflows</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/workflows-introduction">Introduction to workflows</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/workflows-github-actions">Deploy GitHub Runners</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/workflows-airflow">Deploy Airflow</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/workflows-argo">Run Argo workflows</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/workflows-nextflow">Run Nextflow workflows</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dsri-documentation/docs/workflows-cwl">Run CWL workflows</a></li></ul></li></ul></li></ul></div><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_2Tub"></button></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_39qw"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">GPU applications</h1></header><div class="markdown"><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Book a GPU</h5></div><div class="admonition-content"><p><strong>By default you do not have the permission to run applications on GPU</strong>, they need to be booked.</p><p>You can check the availability of our GPUs, and reserve GPU slots in our <a href="/dsri-documentation/gpu-booking">GPU booking calendar 📅</a></p></div></div><p>We are using images provided by Nvidia, and optimized for GPU. We currently deployed Tensorflow and PyTorch with JupyterLab and VSCode, but any image available in the Nvidia catalog should be easy to deploy: <a href="https://ngc.nvidia.com/catalog/containers" target="_blank" rel="noopener noreferrer">https://ngc.nvidia.com/catalog/containers</a></p><p>Checkout <a href="https://github.com/MaastrichtU-IDS/jupyterlab#jupyterlab-on-gpu" target="_blank" rel="noopener noreferrer">this documentation</a> for more details on how we build the optimized docker images for the DSRI GPUs. Feel free to <a href="https://github.com/MaastrichtU-IDS/jupyterlab#extend-an-image" target="_blank" rel="noopener noreferrer">extend the images</a> to your needs.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="start-a-workspace-on-gpu"></a>Start a workspace on GPU<a class="hash-link" href="#start-a-workspace-on-gpu" title="Direct link to heading">#</a></h2><p>Start a workspace in your DSRI project based on Ubuntu, with all drivers and dependencies for accessing the GPU already installed. You will be able to access it using the JupyterLab web UI and VisualStudio Code in the browser.</p><p>Once your project has been granted access to GPUs, you can deploy applications on GPU from the catalog:</p><ol><li>Go to the <a href="https://console-openshift-console.apps.dsri2.unimaas.nl/console/catalog" target="_blank" rel="noopener noreferrer">Catalog web UI</a>: <strong>Add to Project</strong> &gt; <strong>Browse Catalog</strong></li><li>Filter the catalog for  &quot;GPU&quot;</li><li>Choose one of the available templates: <strong>JupyterLab on GPU</strong>.</li><li><strong>Follow the instructions</strong> to create the template in the DSRI web UI, all informations about the images you can use are provided there.</li></ol><p>You can find more details on the images we use and how to extend them in this repository: <a href="https://github.com/MaastrichtU-IDS/jupyterlab#jupyterlab-on-gpu" target="_blank" rel="noopener noreferrer">https://github.com/MaastrichtU-IDS/jupyterlab#jupyterlab-on-gpu</a></p><p>Once your template is created, wait a few seconds before it becomes accessible from the <strong>Topology</strong> page of OpenShift web UI, you can access the JupyterLab web UI, install your dependencies and run your experiments.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Storage</h5></div><div class="admonition-content"><p>Use the <strong><code>/workspace/persistent</code> folder</strong>, which is the JupyterLab workspace, to store your code and data persistently. Note that loading data from the persistent storage will be slowly that what you might expected, this is due to the nature of the distributed storage. So try to optimize this part and avoid reloading multiple time your data, and let us know if it is too much of a problem, we have some solution to improve this</p></div></div><p>You can use the following command in the terminal to see your current GPU usage:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">nvidia-smi</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="tensorboard-logs-visualization"></a>TensorBoard logs visualization<a class="hash-link" href="#tensorboard-logs-visualization" title="Direct link to heading">#</a></h3><p>When using Tensorflow, you can use <a href="https://www.tensorflow.org/tensorboard" target="_blank" rel="noopener noreferrer"><strong>TensorBoard 📈</strong></a> to explore your machine learning runs. It should be already pre-installed in our JupyterLab for GPU templates.</p><p>Follow the usual process to run tensorboard: <a href="https://www.tensorflow.org/tensorboard/get_started" target="_blank" rel="noopener noreferrer">https://www.tensorflow.org/tensorboard/get_started</a></p><ol><li><p>Add the tensorboard callback to your <code>model.fit()</code> function</p></li><li><p>Then start Tensorboard in the terminal with <code>tensorboard --logdir logs</code> (change the directory depending on where the logs of your runs are stored), it should tell you that tensorboard as been started on port 6006</p></li><li><p>Open the Tensorboard view from the JupyterLab welcome page</p></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="increase-the-number-of-gpus-in-your-workspace"></a>Increase the number of GPUs in your workspace<a class="hash-link" href="#increase-the-number-of-gpus-in-your-workspace" title="Direct link to heading">#</a></h3><p>If you already have a application running using 1 GPU, and you have been granted a 2nd GPU to speed up your experiment you can easily upgrade the number of GPU used by your application:</p><p>From the <strong>Topology</strong> view click on your application:</p><ol><li>Stop the application, by decreasing the number of pod to 0 (in the <strong>Details</strong> tab)</li><li>Click on <strong>Options</strong> &gt; <strong>Edit Deployment</strong> &gt; in the YAML of the deployment search for <code>limits</code> and change the number of GPU assigned to your deployment to 2:</li></ol><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-yaml codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token key atrule">resources</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token key atrule">limits</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token key atrule">nvidia.com/gpu</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;2&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token key atrule">requests</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token key atrule">nvidia.com/gpu</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;2&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>You can also do it using the command line, make sure to stop the pod first, and replace <code>jupyterlab-gpu</code> by your app name in this command:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">oc patch dc/jupyterlab-gpu --type</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">json -p</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;[{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/template/spec/containers/0/resources&quot;, &quot;value&quot;: {&quot;requests&quot;: {&quot;nvidia.com/gpu&quot;: 2}, &quot;limits&quot;: {&quot;nvidia.com/gpu&quot;: 2}}}]&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><ol start="3"><li>Restart the pod for your application (the same way you stopped it)</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="install-gpu-drivers-in-any-image"></a>Install GPU drivers in any image<a class="hash-link" href="#install-gpu-drivers-in-any-image" title="Direct link to heading">#</a></h2><p>See the latest official <a href="https://nvidia.github.io/nvidia-container-runtime" target="_blank" rel="noopener noreferrer">Nvidia docs</a> to install the <code>nvidia-container-runtime</code> (all packages and drivers required to access the GPU from your application)</p><p>Here is an example of commands to add to a debian based <code>Dockerfile</code> to install the GPU drivers:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-dockerfile codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">RUN curl -s -L https://nvidia.github.io/nvidia-container-runtime/gpgkey | \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    apt-key add - \ &amp;&amp;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    distribution=$(. /etc/os-release;echo $ID$VERSION_ID) \ &amp;&amp;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    curl -s -L https://nvidia.github.io/nvidia-container-runtime/$distribution/nvidia-container-runtime.list | </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">RUN apt-get update \ &amp;&amp;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    apt-get install -y nvidia-container-runtime</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Then, build your image in your DSRI project using <code>oc</code> from the folder where your put the <code>Dockerfile</code> (replace <code>custom-app-gpu</code> by your app name):</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">oc new-build --name custom-app-gpu --binary</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">oc start-build custom-app-gpu --from-dir</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">. --follow --wait</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">oc new-app custom-app-gpu</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>You will then need to edit the deployment to add the GPU NodeSelector, the <code>serviceAccountName: anyuid</code> and add a persistent storage</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">oc edit custom-app-gpu</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>See also: official <a href="https://docs.nvidia.com/cuda/cuda-installation-guide-linux/index.html#debian-installation" target="_blank" rel="noopener noreferrer">Nvidia docs for CUDA</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="prepare-your-gpu-workspace"></a>Prepare your GPU workspace<a class="hash-link" href="#prepare-your-gpu-workspace" title="Direct link to heading">#</a></h2><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Experimental</h5></div><div class="admonition-content"><p>Experimental: this workflow is still experimental, let us know on Slack #helpdesk if you are interested in using it and helping us improve it.</p></div></div><p>Start a GPU application from the template with <code>0</code> GPU set.</p><p>Access the workspace like you would normally, add your code and data.</p><p>Once the GPU quotas has been granted to your project, you can update your deployment to use the GPUs using this command (our deployment name is <code>jupyterlab-gpu</code> in this example, change it to yours)</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">oc patch dc/jupyterlab-gpu --type</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">json -p</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;[{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/template/spec/containers/0/resources&quot;, &quot;value&quot;: {&quot;requests&quot;: {&quot;nvidia.com/gpu&quot;: 1}, &quot;limits&quot;: {&quot;nvidia.com/gpu&quot;: 1}}}]&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Later you can remove the GPU from your app without stopping it:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">oc patch dc/jupyterlab-gpu --type</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">json -p</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;[{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/template/spec/containers/0/resources&quot;, &quot;value&quot;: {&quot;requests&quot;: {&quot;nvidia.com/gpu&quot;: 0}, &quot;limits&quot;: {&quot;nvidia.com/gpu&quot;: 0}}}]&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/MaastrichtU-IDS/dsri-documentation/edit/master/website/docs/deploy-on-gpu.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2022-02-16T14:36:36.000Z" class="docLastUpdatedAt_217_">2/16/2022</time> by <strong>Vincent Emonet</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/dsri-documentation/docs/catalog-imaging"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Imaging softwares</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/dsri-documentation/docs/catalog-utilities"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Utilities »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_ thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#start-a-workspace-on-gpu" class="table-of-contents__link">Start a workspace on GPU</a><ul><li><a href="#tensorboard-logs-visualization" class="table-of-contents__link">TensorBoard logs visualization</a></li><li><a href="#increase-the-number-of-gpus-in-your-workspace" class="table-of-contents__link">Increase the number of GPUs in your workspace</a></li></ul></li><li><a href="#install-gpu-drivers-in-any-image" class="table-of-contents__link">Install GPU drivers in any image</a></li><li><a href="#prepare-your-gpu-workspace" class="table-of-contents__link">Prepare your GPU workspace</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="text--center"><div><a href="https://creativecommons.org/licenses/by/4.0/" title="Creative Commons Attribution 4.0 International license" target="_blank" rel="noopener noreferrer"><img src="/dsri-documentation/img/cc-by.svg" alt="cc by license"></a></div><div style="margin-bottom:10px">Copyright © 2021 <a href="https://maastrichtuniversity.nl/ids" target="_blank" rel="noopener noreferrer">Institute of Data Science</a> at Maastricht University</div><div style="margin-bottom:10px;color:grey">We don&#x27;t use any tracker, enjoy the freedom and peace of mind 🕊️</div></div></div></footer></div>
<script src="/dsri-documentation/styles.ce1431b2.js"></script>
<script src="/dsri-documentation/runtime~main.ec3a32de.js"></script>
<script src="/dsri-documentation/main.f513770f.js"></script>
<script src="/dsri-documentation/1.e90966bd.js"></script>
<script src="/dsri-documentation/1f391b9e.e7c3fa56.js"></script>
<script src="/dsri-documentation/81.99b39d61.js"></script>
<script src="/dsri-documentation/935f2afb.24337b0b.js"></script>
<script src="/dsri-documentation/79.9c645739.js"></script>
<script src="/dsri-documentation/707d3f57.950e90a2.js"></script>
</body>
</html>