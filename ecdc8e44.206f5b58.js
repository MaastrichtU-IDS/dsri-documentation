(window.webpackJsonp=window.webpackJsonp||[]).push([[87],{156:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return p})),a.d(t,"metadata",(function(){return c})),a.d(t,"rightToc",(function(){return i})),a.d(t,"default",(function(){return s}));var r=a(3),n=a(7),o=(a(0),a(166)),p={id:"deploy-spark",title:"Spark cluster"},c={unversionedId:"deploy-spark",id:"deploy-spark",isDocsHomePage:!1,title:"Spark cluster",description:"To be able to deploy Spark you will need to ask the DSRI admins to enable the Spark Operator in your project. It will be done quickly, once enabled you will be able to start a Spark cluster in a few clicks.",source:"@site/docs/deploy-spark.md",slug:"/deploy-spark",permalink:"/dsri-documentation/docs/deploy-spark",editUrl:"https://github.com/MaastrichtU-IDS/dsri-documentation/edit/master/website/docs/deploy-spark.md",version:"current",lastUpdatedBy:"Vincent Emonet",lastUpdatedAt:1615366959,sidebar:"docs",previous:{title:"Databases",permalink:"/dsri-documentation/docs/deploy-database"},next:{title:"OpenMPI",permalink:"/dsri-documentation/docs/catalog-openmpi"}},i=[{value:"Deploy a Spark cluster",id:"deploy-a-spark-cluster",children:[]},{value:"Run on Spark",id:"run-on-spark",children:[{value:"Using PySpark",id:"using-pyspark",children:[]}]},{value:"Delete a running Spark cluster",id:"delete-a-running-spark-cluster",children:[]}],l={rightToc:i};function s(e){var t=e.components,a=Object(n.a)(e,["components"]);return Object(o.b)("wrapper",Object(r.a)({},l,a,{components:t,mdxType:"MDXLayout"}),Object(o.b)("div",{className:"admonition admonition-warning alert alert--danger"},Object(o.b)("div",{parentName:"div",className:"admonition-heading"},Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",{parentName:"h5",className:"admonition-icon"},Object(o.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},Object(o.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"Request access to the Spark Operator")),Object(o.b)("div",{parentName:"div",className:"admonition-content"},Object(o.b)("p",{parentName:"div"},"To be able to deploy Spark you will need to ",Object(o.b)("a",{parentName:"p",href:"/dsri-documentation/help"},"ask the DSRI admins")," to enable the Spark Operator in your project. It will be done quickly, once enabled you will be able to start a Spark cluster in a few clicks."))),Object(o.b)("h2",{id:"deploy-a-spark-cluster"},"Deploy a Spark cluster"),Object(o.b)("p",null,"Once the DSRI admins have enabled the Spark Operator your project, you should found a ",Object(o.b)("strong",{parentName:"p"},"Spark Cluster")," entry in the Catalog (in the ",Object(o.b)("strong",{parentName:"p"},"Operator Backed")," category)"),Object(o.b)("img",{src:"/dsri-documentation/img/screenshot-spark-operator1.png",alt:"Apache Spark in the Catalog",style:{maxWidth:"100%",maxHeight:"100%"}}),Object(o.b)("p",null,"Click on the ",Object(o.b)("strong",{parentName:"p"},"Spark Cluster")," entry to deploy a Spark cluster."),Object(o.b)("p",null,"You will be presented a form where you can provide the number of Spark workers in your cluster. "),Object(o.b)("p",null,"Additionally you can provide a label which can be helpful later to manage or delete the cluster, use the name of your application and the label ",Object(o.b)("inlineCode",{parentName:"p"},"app"),", e.g.: ",Object(o.b)("inlineCode",{parentName:"p"},"app=my-spark-cluster")),Object(o.b)("img",{src:"/dsri-documentation/img/screenshot-spark-operator2.png",alt:"Deploy a Apache Spark cluster",style:{maxWidth:"100%",maxHeight:"100%"}}),Object(o.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(o.b)("div",{parentName:"div",className:"admonition-heading"},Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",{parentName:"h5",className:"admonition-icon"},Object(o.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},Object(o.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Change ")),Object(o.b)("div",{parentName:"div",className:"admonition-content"},Object(o.b)("p",{parentName:"div"},"The number of Spark workers can be easily updated later in the Spark deployment YAML file."))),Object(o.b)("h2",{id:"run-on-spark"},"Run on Spark"),Object(o.b)("p",null,"You can now start a spark-enabled JupyterLab, or any other spark-enabled applications, to use the Spark cluster deployed."),Object(o.b)("h3",{id:"using-pyspark"},"Using PySpark"),Object(o.b)("p",null,"Use local Spark for testing, it will use ",Object(o.b)("inlineCode",{parentName:"p"},"local[*]")," as Spark cluster"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-python"},'import findspark\nfindspark.init()\nimport pyspark\nsc = pyspark.SparkContext(appName="Pi")\n')),Object(o.b)("p",null,"Use the deployed Spark cluster:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-shell"},'import pyspark\nsc = pyspark.SparkContext(appName="Pi", master="spark://my-spark-spark-master:7077")\n')),Object(o.b)("h2",{id:"delete-a-running-spark-cluster"},"Delete a running Spark cluster"),Object(o.b)("p",null,"Get all objects part of the Spark cluster:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-bash"},"oc get all,secret,configmaps --selector app=spark\n")))}s.isMDXComponent=!0},166:function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return m}));var r=a(0),n=a.n(r);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=n.a.createContext({}),s=function(e){var t=n.a.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):c(c({},t),e)),a},d=function(e){var t=s(e.components);return n.a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.a.createElement(n.a.Fragment,{},t)}},b=n.a.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,l=i(e,["components","mdxType","originalType","parentName"]),d=s(a),b=r,m=d["".concat(p,".").concat(b)]||d[b]||u[b]||o;return a?n.a.createElement(m,c(c({ref:t},l),{},{components:a})):n.a.createElement(m,c({ref:t},l))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,p=new Array(o);p[0]=b;var c={};for(var i in t)hasOwnProperty.call(t,i)&&(c[i]=t[i]);c.originalType=e,c.mdxType="string"==typeof e?e:r,p[1]=c;for(var l=2;l<o;l++)p[l]=a[l];return n.a.createElement.apply(null,p)}return n.a.createElement.apply(null,a)}b.displayName="MDXCreateElement"}}]);